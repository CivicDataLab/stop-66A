{"ast":null,"code":"var _jsxFileName = \"/home/ubuntu/myprojectdir/tracker/covid19india-react/src/components/State.js\";\nimport DeltaBarGraph from './DeltaBarGraph';\nimport Footer from './Footer';\nimport Level from './Level';\nimport MapSwitcher from './MapSwitcher';\nimport StateHeader from './StateHeader';\nimport StateMeta from './StateMeta';\nimport { API_ROOT_URL, STATE_NAMES } from '../constants';\nimport useIsVisible from '../hooks/useIsVisible';\nimport { fetcher, formatNumber, getStatistic } from '../utils/commonFunctions';\nimport classnames from 'classnames';\nimport React, { useMemo, useState, useEffect, lazy, Suspense, useRef } from 'react';\nimport { Smile } from 'react-feather';\nimport { Helmet } from 'react-helmet';\nimport { useTranslation } from 'react-i18next';\nimport { useParams } from 'react-router-dom';\nimport { useSessionStorage } from 'react-use';\nimport useSWR from 'swr';\nconst TimeseriesExplorer = lazy(() => import('./TimeseriesExplorer'));\nconst MapExplorer = lazy(() => import('./MapExplorer'));\nconst Minigraphs = lazy(() => import('./Minigraphs'));\n\nfunction State() {\n  var _timeseries$stateCode, _timeseries$stateCode2, _data$stateCode2, _timeseries$stateCode3, _timeseries$stateCode4, _data$stateCode3;\n\n  const {\n    t\n  } = useTranslation();\n  const stateCode = useParams().stateCode.toUpperCase();\n  const [mapStatistic, setMapStatistic] = useSessionStorage('mapStatistic', 'active');\n  const [showAllDistricts, setShowAllDistricts] = useState(false);\n  const [regionHighlighted, setRegionHighlighted] = useState({\n    stateCode: stateCode,\n    districtName: null\n  });\n  useEffect(() => {\n    if (regionHighlighted.stateCode !== stateCode) {\n      setRegionHighlighted({\n        stateCode: stateCode,\n        districtName: null\n      });\n      setShowAllDistricts(false);\n    }\n  }, [regionHighlighted.stateCode, stateCode]);\n  const {\n    data: timeseries,\n    error: timeseriesResponseError\n  } = useSWR(`${API_ROOT_URL}/timeseries-${stateCode}.min.json`, fetcher, {\n    revalidateOnMount: true,\n    refreshInterval: 100000\n  });\n  const {\n    data\n  } = useSWR(`${API_ROOT_URL}/data.min.json`, fetcher, {\n    revalidateOnMount: true,\n    refreshInterval: 100000\n  });\n\n  const toggleShowAllDistricts = () => {\n    setShowAllDistricts(!showAllDistricts);\n  };\n\n  const handleSort = (districtNameA, districtNameB) => {\n    const districtA = data[stateCode].districts[districtNameA];\n    const districtB = data[stateCode].districts[districtNameB];\n    return getStatistic(districtB, 'total', mapStatistic) - getStatistic(districtA, 'total', mapStatistic);\n  };\n\n  const gridRowCount = useMemo(() => {\n    var _data$stateCode;\n\n    if (!data) return;\n    const gridColumnCount = window.innerWidth >= 540 ? 3 : 2;\n    const districtCount = ((_data$stateCode = data[stateCode]) === null || _data$stateCode === void 0 ? void 0 : _data$stateCode.districts) ? Object.keys(data[stateCode].districts).filter(districtName => districtName !== 'Unknown').length : 0;\n    const gridRowCount = Math.ceil(districtCount / gridColumnCount);\n    return gridRowCount;\n  }, [data, stateCode]);\n  const stateMetaElement = useRef();\n  const isStateMetaVisible = useIsVisible(stateMetaElement, {\n    once: true\n  });\n  const trail = useMemo(() => {\n    const styles = [];\n    [0, 0, 0, 0].map((element, index) => {\n      styles.push({\n        animationDelay: `${index * 250}ms`\n      });\n      return null;\n    });\n    return styles;\n  }, []);\n  const lookback = showAllDistricts ? window.innerWidth >= 540 ? 10 : 8 : 6;\n  return /*#__PURE__*/React.createElement(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Helmet, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"title\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 9\n    }\n  }, \"Coronavirus Outbreak in \", STATE_NAMES[stateCode], \" - covid19india.org\"), /*#__PURE__*/React.createElement(\"meta\", {\n    name: \"title\",\n    content: `Coronavirus Outbreak in ${STATE_NAMES[stateCode]}: Latest Map and Case Count`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"State\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"state-left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(StateHeader, {\n    data: data === null || data === void 0 ? void 0 : data[stateCode],\n    stateCode: stateCode,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      position: 'relative'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(MapSwitcher, Object.assign({\n    mapStatistic,\n    setMapStatistic\n  }, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Level, {\n    data: data === null || data === void 0 ? void 0 : data[stateCode],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Minigraphs, Object.assign({\n    timeseries: timeseries === null || timeseries === void 0 ? void 0 : (_timeseries$stateCode = timeseries[stateCode]) === null || _timeseries$stateCode === void 0 ? void 0 : _timeseries$stateCode.dates\n  }, {\n    stateCode\n  }, {\n    forceRender: !!timeseriesResponseError,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 13\n    }\n  }))), data && /*#__PURE__*/React.createElement(Suspense, {\n    fallback: /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        minHeight: '50rem'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 33\n      }\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(MapExplorer, Object.assign({\n    stateCode,\n    data,\n    regionHighlighted,\n    setRegionHighlighted,\n    mapStatistic,\n    setMapStatistic\n  }, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 15\n    }\n  }))), /*#__PURE__*/React.createElement(\"span\", {\n    ref: stateMetaElement,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 11\n    }\n  }), data && isStateMetaVisible && /*#__PURE__*/React.createElement(StateMeta, Object.assign({\n    stateCode,\n    data\n  }, {\n    timeseries: timeseries === null || timeseries === void 0 ? void 0 : (_timeseries$stateCode2 = timeseries[stateCode]) === null || _timeseries$stateCode2 === void 0 ? void 0 : _timeseries$stateCode2.dates,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 13\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"state-right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"district-bar\",\n    style: !showAllDistricts ? {\n      display: 'flex'\n    } : {},\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"district-bar-top\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"district-bar-left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    className: classnames(mapStatistic, 'fadeInUp'),\n    style: trail[0],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 19\n    }\n  }, \"Top districts\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: `districts fadeInUp ${showAllDistricts ? 'is-grid' : ''}`,\n    style: showAllDistricts ? {\n      gridTemplateRows: `repeat(${gridRowCount}, 2rem)`,\n      ...trail[1]\n    } : trail[1],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 19\n    }\n  }, Object.keys((data === null || data === void 0 ? void 0 : (_data$stateCode2 = data[stateCode]) === null || _data$stateCode2 === void 0 ? void 0 : _data$stateCode2.districts) || {}).filter(districtName => districtName !== 'Unknown').sort((a, b) => handleSort(a, b)).slice(0, showAllDistricts ? undefined : 5).map(districtName => {\n    const total = getStatistic(data[stateCode].districts[districtName], 'total', mapStatistic);\n    const delta = getStatistic(data[stateCode].districts[districtName], 'delta', mapStatistic);\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: districtName,\n      className: \"district\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 27\n      }\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 29\n      }\n    }, formatNumber(total)), /*#__PURE__*/React.createElement(\"h5\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 29\n      }\n    }, t(districtName)), mapStatistic !== 'active' && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"delta\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 31\n      }\n    }, /*#__PURE__*/React.createElement(\"h6\", {\n      className: mapStatistic,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 33\n      }\n    }, delta > 0 ? '\\u2191' + formatNumber(delta) : '')));\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"district-bar-right fadeInUp\",\n    style: trail[2],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 228,\n      columnNumber: 17\n    }\n  }, timeseries && (mapStatistic === 'confirmed' || mapStatistic === 'deceased') && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"happy-sign\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 23\n    }\n  }, Object.keys(((_timeseries$stateCode3 = timeseries[stateCode]) === null || _timeseries$stateCode3 === void 0 ? void 0 : _timeseries$stateCode3.dates) || {}).slice(-lookback).every(date => getStatistic(timeseries[stateCode].dates[date], 'delta', mapStatistic) === 0) && /*#__PURE__*/React.createElement(\"div\", {\n    className: `alert ${mapStatistic === 'confirmed' ? 'is-green' : ''}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 27\n    }\n  }, /*#__PURE__*/React.createElement(Smile, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 29\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"alert-right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 249,\n      columnNumber: 29\n    }\n  }, \"No new \", mapStatistic, \" cases in the past five days\"))), /*#__PURE__*/React.createElement(DeltaBarGraph, Object.assign({\n    timeseries: timeseries === null || timeseries === void 0 ? void 0 : (_timeseries$stateCode4 = timeseries[stateCode]) === null || _timeseries$stateCode4 === void 0 ? void 0 : _timeseries$stateCode4.dates,\n    statistic: mapStatistic\n  }, {\n    stateCode,\n    lookback\n  }, {\n    forceRender: !!timeseriesResponseError,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 19\n    }\n  })))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"district-bar-bottom\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 265,\n      columnNumber: 15\n    }\n  }, Object.keys((data === null || data === void 0 ? void 0 : (_data$stateCode3 = data[stateCode]) === null || _data$stateCode3 === void 0 ? void 0 : _data$stateCode3.districts) || {}).length > 5 ? /*#__PURE__*/React.createElement(\"button\", {\n    className: \"button fadeInUp\",\n    onClick: toggleShowAllDistricts,\n    style: trail[3],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 267,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 272,\n      columnNumber: 21\n    }\n  }, showAllDistricts ? `View less` : `View all`)) : /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      height: '3.75rem',\n      flexBasis: '15%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 275,\n      columnNumber: 19\n    }\n  }))), /*#__PURE__*/React.createElement(Suspense, {\n    fallback: /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 33\n      }\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 280,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(TimeseriesExplorer, Object.assign({\n    stateCode,\n    timeseries,\n    regionHighlighted,\n    setRegionHighlighted\n  }, {\n    forceRender: !!timeseriesResponseError,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 281,\n      columnNumber: 15\n    }\n  })))))), /*#__PURE__*/React.createElement(Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 295,\n      columnNumber: 7\n    }\n  }));\n}\n\nexport default React.memo(State);","map":{"version":3,"sources":["/home/ubuntu/myprojectdir/tracker/covid19india-react/src/components/State.js"],"names":["DeltaBarGraph","Footer","Level","MapSwitcher","StateHeader","StateMeta","API_ROOT_URL","STATE_NAMES","useIsVisible","fetcher","formatNumber","getStatistic","classnames","React","useMemo","useState","useEffect","lazy","Suspense","useRef","Smile","Helmet","useTranslation","useParams","useSessionStorage","useSWR","TimeseriesExplorer","MapExplorer","Minigraphs","State","t","stateCode","toUpperCase","mapStatistic","setMapStatistic","showAllDistricts","setShowAllDistricts","regionHighlighted","setRegionHighlighted","districtName","data","timeseries","error","timeseriesResponseError","revalidateOnMount","refreshInterval","toggleShowAllDistricts","handleSort","districtNameA","districtNameB","districtA","districts","districtB","gridRowCount","gridColumnCount","window","innerWidth","districtCount","Object","keys","filter","length","Math","ceil","stateMetaElement","isStateMetaVisible","once","trail","styles","map","element","index","push","animationDelay","lookback","position","dates","minHeight","display","gridTemplateRows","sort","a","b","slice","undefined","total","delta","every","date","height","flexBasis","memo"],"mappings":"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","sourcesContent":["import DeltaBarGraph from './DeltaBarGraph';\nimport Footer from './Footer';\nimport Level from './Level';\nimport MapSwitcher from './MapSwitcher';\nimport StateHeader from './StateHeader';\nimport StateMeta from './StateMeta';\n\nimport {API_ROOT_URL, STATE_NAMES} from '../constants';\nimport useIsVisible from '../hooks/useIsVisible';\nimport {fetcher, formatNumber, getStatistic} from '../utils/commonFunctions';\n\nimport classnames from 'classnames';\nimport React, {\n  useMemo,\n  useState,\n  useEffect,\n  lazy,\n  Suspense,\n  useRef,\n} from 'react';\nimport {Smile} from 'react-feather';\nimport {Helmet} from 'react-helmet';\nimport {useTranslation} from 'react-i18next';\nimport {useParams} from 'react-router-dom';\nimport {useSessionStorage} from 'react-use';\nimport useSWR from 'swr';\n\nconst TimeseriesExplorer = lazy(() => import('./TimeseriesExplorer'));\nconst MapExplorer = lazy(() => import('./MapExplorer'));\nconst Minigraphs = lazy(() => import('./Minigraphs'));\n\nfunction State() {\n  const {t} = useTranslation();\n\n  const stateCode = useParams().stateCode.toUpperCase();\n\n  const [mapStatistic, setMapStatistic] = useSessionStorage(\n    'mapStatistic',\n    'active'\n  );\n  const [showAllDistricts, setShowAllDistricts] = useState(false);\n  const [regionHighlighted, setRegionHighlighted] = useState({\n    stateCode: stateCode,\n    districtName: null,\n  });\n\n  useEffect(() => {\n    if (regionHighlighted.stateCode !== stateCode) {\n      setRegionHighlighted({\n        stateCode: stateCode,\n        districtName: null,\n      });\n      setShowAllDistricts(false);\n    }\n  }, [regionHighlighted.stateCode, stateCode]);\n\n  const {data: timeseries, error: timeseriesResponseError} = useSWR(\n    `${API_ROOT_URL}/timeseries-${stateCode}.min.json`,\n    fetcher,\n    {\n      revalidateOnMount: true,\n      refreshInterval: 100000,\n    }\n  );\n\n  const {data} = useSWR(`${API_ROOT_URL}/data.min.json`, fetcher, {\n    revalidateOnMount: true,\n    refreshInterval: 100000,\n  });\n\n  const toggleShowAllDistricts = () => {\n    setShowAllDistricts(!showAllDistricts);\n  };\n\n  const handleSort = (districtNameA, districtNameB) => {\n    const districtA = data[stateCode].districts[districtNameA];\n    const districtB = data[stateCode].districts[districtNameB];\n    return (\n      getStatistic(districtB, 'total', mapStatistic) -\n      getStatistic(districtA, 'total', mapStatistic)\n    );\n  };\n\n  const gridRowCount = useMemo(() => {\n    if (!data) return;\n    const gridColumnCount = window.innerWidth >= 540 ? 3 : 2;\n    const districtCount = data[stateCode]?.districts\n      ? Object.keys(data[stateCode].districts).filter(\n          (districtName) => districtName !== 'Unknown'\n        ).length\n      : 0;\n    const gridRowCount = Math.ceil(districtCount / gridColumnCount);\n    return gridRowCount;\n  }, [data, stateCode]);\n\n  const stateMetaElement = useRef();\n  const isStateMetaVisible = useIsVisible(stateMetaElement, {once: true});\n\n  const trail = useMemo(() => {\n    const styles = [];\n\n    [0, 0, 0, 0].map((element, index) => {\n      styles.push({\n        animationDelay: `${index * 250}ms`,\n      });\n      return null;\n    });\n    return styles;\n  }, []);\n\n  const lookback = showAllDistricts ? (window.innerWidth >= 540 ? 10 : 8) : 6;\n\n  return (\n    <React.Fragment>\n      <Helmet>\n        <title>\n          Coronavirus Outbreak in {STATE_NAMES[stateCode]} - covid19india.org\n        </title>\n        <meta\n          name=\"title\"\n          content={`Coronavirus Outbreak in ${STATE_NAMES[stateCode]}: Latest Map and Case Count`}\n        />\n      </Helmet>\n\n      <div className=\"State\">\n        <div className=\"state-left\">\n          <StateHeader data={data?.[stateCode]} stateCode={stateCode} />\n\n          <div style={{position: 'relative'}}>\n            <MapSwitcher {...{mapStatistic, setMapStatistic}} />\n            <Level data={data?.[stateCode]} />\n            <Minigraphs\n              timeseries={timeseries?.[stateCode]?.dates}\n              {...{stateCode}}\n              forceRender={!!timeseriesResponseError}\n            />\n          </div>\n\n          {data && (\n            <Suspense fallback={<div style={{minHeight: '50rem'}} />}>\n              <MapExplorer\n                {...{\n                  stateCode,\n                  data,\n                  regionHighlighted,\n                  setRegionHighlighted,\n                  mapStatistic,\n                  setMapStatistic,\n                }}\n              ></MapExplorer>\n            </Suspense>\n          )}\n\n          <span ref={stateMetaElement} />\n\n          {data && isStateMetaVisible && (\n            <StateMeta\n              {...{\n                stateCode,\n                data,\n              }}\n              timeseries={timeseries?.[stateCode]?.dates}\n            />\n          )}\n        </div>\n\n        <div className=\"state-right\">\n          <React.Fragment>\n            <div\n              className=\"district-bar\"\n              style={!showAllDistricts ? {display: 'flex'} : {}}\n            >\n              <div className=\"district-bar-top\">\n                <div className=\"district-bar-left\">\n                  <h2\n                    className={classnames(mapStatistic, 'fadeInUp')}\n                    style={trail[0]}\n                  >\n                    Top districts\n                  </h2>\n                  <div\n                    className={`districts fadeInUp ${\n                      showAllDistricts ? 'is-grid' : ''\n                    }`}\n                    style={\n                      showAllDistricts\n                        ? {\n                            gridTemplateRows: `repeat(${gridRowCount}, 2rem)`,\n                            ...trail[1],\n                          }\n                        : trail[1]\n                    }\n                  >\n                    {Object.keys(data?.[stateCode]?.districts || {})\n                      .filter((districtName) => districtName !== 'Unknown')\n                      .sort((a, b) => handleSort(a, b))\n                      .slice(0, showAllDistricts ? undefined : 5)\n                      .map((districtName) => {\n                        const total = getStatistic(\n                          data[stateCode].districts[districtName],\n                          'total',\n                          mapStatistic\n                        );\n                        const delta = getStatistic(\n                          data[stateCode].districts[districtName],\n                          'delta',\n                          mapStatistic\n                        );\n                        return (\n                          <div key={districtName} className=\"district\">\n                            <h2>{formatNumber(total)}</h2>\n                            <h5>{t(districtName)}</h5>\n                            {mapStatistic !== 'active' && (\n                              <div className=\"delta\">\n                                <h6 className={mapStatistic}>\n                                  {delta > 0\n                                    ? '\\u2191' + formatNumber(delta)\n                                    : ''}\n                                </h6>\n                              </div>\n                            )}\n                          </div>\n                        );\n                      })}\n                  </div>\n                </div>\n\n                <div className=\"district-bar-right fadeInUp\" style={trail[2]}>\n                  {timeseries &&\n                    (mapStatistic === 'confirmed' ||\n                      mapStatistic === 'deceased') && (\n                      <div className=\"happy-sign\">\n                        {Object.keys(timeseries[stateCode]?.dates || {})\n                          .slice(-lookback)\n                          .every(\n                            (date) =>\n                              getStatistic(\n                                timeseries[stateCode].dates[date],\n                                'delta',\n                                mapStatistic\n                              ) === 0\n                          ) && (\n                          <div\n                            className={`alert ${\n                              mapStatistic === 'confirmed' ? 'is-green' : ''\n                            }`}\n                          >\n                            <Smile />\n                            <div className=\"alert-right\">\n                              No new {mapStatistic} cases in the past five days\n                            </div>\n                          </div>\n                        )}\n                      </div>\n                    )}\n                  <DeltaBarGraph\n                    timeseries={timeseries?.[stateCode]?.dates}\n                    statistic={mapStatistic}\n                    {...{stateCode, lookback}}\n                    forceRender={!!timeseriesResponseError}\n                  />\n                </div>\n              </div>\n\n              <div className=\"district-bar-bottom\">\n                {Object.keys(data?.[stateCode]?.districts || {}).length > 5 ? (\n                  <button\n                    className=\"button fadeInUp\"\n                    onClick={toggleShowAllDistricts}\n                    style={trail[3]}\n                  >\n                    <span>{showAllDistricts ? `View less` : `View all`}</span>\n                  </button>\n                ) : (\n                  <div style={{height: '3.75rem', flexBasis: '15%'}} />\n                )}\n              </div>\n            </div>\n\n            <Suspense fallback={<div />}>\n              <TimeseriesExplorer\n                {...{\n                  stateCode,\n                  timeseries,\n                  regionHighlighted,\n                  setRegionHighlighted,\n                }}\n                forceRender={!!timeseriesResponseError}\n              />\n            </Suspense>\n          </React.Fragment>\n        </div>\n      </div>\n\n      <Footer />\n    </React.Fragment>\n  );\n}\n\nexport default React.memo(State);\n"]},"metadata":{},"sourceType":"module"}