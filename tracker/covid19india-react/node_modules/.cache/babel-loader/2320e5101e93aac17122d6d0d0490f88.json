{"ast":null,"code":"import _slicedToArray from\"/home/ubuntu/myprojectdir/tracker/covid19india-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{D3_TRANSITION_DURATION,STATISTIC_CONFIGS,TIMESERIES_STATISTICS}from'../constants';import{useResizeObserver}from'../hooks/useResizeObserver';import{capitalize,formatNumber,formatDate,getStatistic,parseIndiaDate}from'../utils/commonFunctions';import classnames from'classnames';import{min,max,bisector}from'd3-array';import{axisBottom,axisRight}from'd3-axis';import{interpolatePath}from'd3-interpolate-path';import{scaleTime,scaleLinear,scaleLog}from'd3-scale';import{select,mouse}from'd3-selection';import{line,curveMonotoneX}from'd3-shape';// eslint-disable-next-line\nimport{transition}from'd3-transition';import equal from'fast-deep-equal';import React,{useCallback,useEffect,useRef,useMemo,useState}from'react';import{useTranslation}from'react-i18next';// Chart margins\nvar margin={top:15,right:35,bottom:25,left:25};function Timeseries(_ref){var timeseries=_ref.timeseries,dates=_ref.dates,chartType=_ref.chartType,isUniform=_ref.isUniform,isLog=_ref.isLog;var _useTranslation=useTranslation(),t=_useTranslation.t;var refs=useRef([]);var wrapperRef=useRef();var dimensions=useResizeObserver(wrapperRef);var _useState=useState(),_useState2=_slicedToArray(_useState,2),highlightedDate=_useState2[0],setHighlightedDate=_useState2[1];useEffect(function(){setHighlightedDate(dates[dates.length-1]);},[dates]);var getBarWidth=useCallback(function(){var T=dates.length;// Dimensions\nvar _ref2=dimensions||wrapperRef.current.getBoundingClientRect(),width=_ref2.width;// Chart extremes\nvar chartRight=width-margin.right;// Bar widths\nvar axisWidth=chartRight-margin.left;return Math.min(4,axisWidth/(1.25*T));},[dates.length,dimensions]);useEffect(function(){var T=dates.length;// Dimensions\nvar _ref3=dimensions||wrapperRef.current.getBoundingClientRect(),width=_ref3.width,height=_ref3.height;// Chart extremes\nvar chartRight=width-margin.right;var chartBottom=height-margin.bottom;var barWidth=getBarWidth();// Buffer space along y-axis\nvar yBufferTop=1.2;var yBufferBottom=1.1;var xScale=scaleTime().clamp(true).domain(T?[parseIndiaDate(dates[0]),parseIndiaDate(dates[T-1])]:[]).range([margin.left,chartRight]);// Number of x-axis ticks\nvar numTicksX=width<480?4:7;var xAxis=function xAxis(g){return g.attr('class','x-axis').call(axisBottom(xScale).ticks(numTicksX).tickFormat(function(date){return formatDate(date,'dd MMM');}));};var xAxis2=function xAxis2(g,yScale){g.attr('class','x-axis2').call(axisBottom(xScale).tickValues([]).tickSize(0)).select('.domain').style('transform',\"translateY(\".concat(yScale(0),\"px)\"));if(yScale(0)!==chartBottom)g.select('.domain').attr('opacity',0.4);else g.select('.domain').attr('opacity',0);};var yAxis=function yAxis(g,yScale){return g.attr('class','y-axis').call(axisRight(yScale).ticks(4).tickFormat(function(num){return formatNumber(num,'short');}).tickPadding(4));};var uniformScaleMin=min(dates,function(date){return getStatistic(timeseries[date],chartType,'active');});var uniformScaleMax=max(dates,function(date){return Math.max(getStatistic(timeseries[date],chartType,'confirmed'),getStatistic(timeseries[date],chartType,'recovered'),getStatistic(timeseries[date],chartType,'deceased'));});var yScaleUniformLinear=scaleLinear().clamp(true).domain([uniformScaleMin,Math.max(1,yBufferTop*uniformScaleMax)]).nice(4).range([chartBottom,margin.top]);var yScaleUniformLog=scaleLog().clamp(true).domain([Math.max(1,uniformScaleMin),Math.max(10,yBufferTop*uniformScaleMax)]).nice(4).range([chartBottom,margin.top]);var generateYScale=function generateYScale(statistic){if(isUniform&&chartType==='total'&&isLog&&statistic!=='tested')return yScaleUniformLog;if(isUniform&&statistic!=='tested')return yScaleUniformLinear;if(chartType==='total'&&isLog)return scaleLog().clamp(true).domain([Math.max(1,min(dates,function(date){return getStatistic(timeseries[date],chartType,statistic);})),Math.max(10,yBufferTop*max(dates,function(date){return getStatistic(timeseries[date],chartType,statistic);}))]).nice(4).range([chartBottom,margin.top]);return scaleLinear().clamp(true).domain([yBufferBottom*Math.min(0,min(dates,function(date){return getStatistic(timeseries[date],chartType,statistic);})),Math.max(1,yBufferTop*max(dates,function(date){return getStatistic(timeseries[date],chartType,statistic);}))]).nice(4).range([chartBottom,margin.top]);};function mousemove(){var xm=mouse(this)[0];var date=xScale.invert(xm);if(!isNaN(date)){var bisectDate=bisector(function(date){return parseIndiaDate(date);}).left;var index=bisectDate(dates,date,1);var dateLeft=dates[index-1];var dateRight=dates[index];setHighlightedDate(date-parseIndiaDate(dateLeft)<parseIndiaDate(dateRight)-date?dateLeft:dateRight);}}function mouseout(){setHighlightedDate(dates[T-1]);}/* Begin drawing charts */refs.current.forEach(function(ref,i){var svg=select(ref);var t=svg.transition().duration(D3_TRANSITION_DURATION);var statistic=TIMESERIES_STATISTICS[i];var yScale=generateYScale(statistic);var color=STATISTIC_CONFIGS[statistic].color;/* X axis */svg.select('.x-axis').style('transform',\"translateY(\".concat(chartBottom,\"px)\")).transition(t).call(xAxis);svg.select('.x-axis2').transition(t).call(xAxis2,yScale);/* Y axis */svg.select('.y-axis').style('transform',\"translateX(\".concat(chartRight,\"px)\")).transition(t).call(yAxis,yScale);/* Path dots */svg.selectAll('circle').data(dates,function(date){return date;}).join(function(enter){return enter.append('circle').attr('fill',color).attr('stroke',color).attr('cy',chartBottom).attr('cx',function(date){return xScale(parseIndiaDate(date));}).attr('r',barWidth/2);}).transition(t).attr('cx',function(date){return xScale(parseIndiaDate(date));}).attr('cy',function(date){return yScale(getStatistic(timeseries[date],chartType,statistic));});if(chartType==='total'){svg.selectAll('.stem').transition(t).attr('y1',yScale(0)).attr('y2',yScale(0)).remove();var linePath=line().curve(curveMonotoneX).x(function(date){return xScale(parseIndiaDate(date));}).y(function(date){return yScale(getStatistic(timeseries[date],chartType,statistic));});var pathLength;svg.selectAll('.trend').data(T?[dates]:[]).join(function(enter){return enter.append('path').attr('class','trend').attr('fill','none').attr('stroke',color+'50').attr('stroke-width',4).attr('d',linePath).attr('stroke-dasharray',function(){return pathLength=this.getTotalLength();}).call(function(enter){return enter.attr('stroke-dashoffset',pathLength).transition(t).attr('stroke-dashoffset',0);});},function(update){return update.attr('stroke-dasharray',null).transition(t).attrTween('d',function(date){var previous=select(this).attr('d');var current=linePath(date);return interpolatePath(previous,current);});});}else{/* DAILY TRENDS */svg.selectAll('.trend').remove();svg.selectAll('.stem').data(dates,function(date){return date;}).join(function(enter){return enter.append('line').attr('class','stem').attr('stroke-width',barWidth).attr('x1',function(date){return xScale(parseIndiaDate(date));}).attr('y1',chartBottom).attr('x2',function(date){return xScale(parseIndiaDate(date));}).attr('y2',chartBottom);}).transition(t).attr('stroke-width',barWidth).attr('x1',function(date){return xScale(parseIndiaDate(date));}).attr('y1',yScale(0)).attr('x2',function(date){return xScale(parseIndiaDate(date));}).attr('y2',function(date){return yScale(getStatistic(timeseries[date],chartType,statistic));});}svg.selectAll('*').attr('pointer-events','none');svg.on('mousemove',mousemove).on('touchmove',mousemove).on('mouseout',mouseout).on('touchend',mouseout);});},[chartType,dimensions,getBarWidth,isUniform,isLog,timeseries,dates]);useEffect(function(){var barWidth=getBarWidth();refs.current.forEach(function(ref){var svg=select(ref);svg.selectAll('circle').attr('r',function(date){return date===highlightedDate?barWidth:barWidth/2;});});},[highlightedDate,getBarWidth]);var getStatisticDelta=useCallback(function(statistic){if(!highlightedDate)return;var currCount=getStatistic(timeseries===null||timeseries===void 0?void 0:timeseries[highlightedDate],chartType,statistic);var prevDate=dates[dates.findIndex(function(date){return date===highlightedDate;})-1];var prevCount=getStatistic(timeseries===null||timeseries===void 0?void 0:timeseries[prevDate],chartType,statistic);return currCount-prevCount;},[timeseries,dates,highlightedDate,chartType]);var trail=useMemo(function(){var styles=[];[0,0,0,0,0].map(function(element,index){styles.push({animationDelay:\"\".concat(index*250,\"ms\")});return null;});return styles;},[]);return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"Timeseries\"},TIMESERIES_STATISTICS.map(function(statistic,index){var delta=getStatisticDelta(statistic,index);var statisticConfig=STATISTIC_CONFIGS[statistic];return/*#__PURE__*/React.createElement(\"div\",{key:statistic,className:classnames('svg-parent fadeInUp',\"is-\".concat(statistic)),ref:wrapperRef,style:trail[index]},highlightedDate&&/*#__PURE__*/React.createElement(\"div\",{className:classnames('stats',\"is-\".concat(statistic))},/*#__PURE__*/React.createElement(\"h5\",{className:\"title\"},t(capitalize(statisticConfig.displayName))),/*#__PURE__*/React.createElement(\"h5\",{className:\"title\"},formatDate(highlightedDate,'dd MMMM')),/*#__PURE__*/React.createElement(\"div\",{className:\"stats-bottom\"},/*#__PURE__*/React.createElement(\"h2\",null,formatNumber(getStatistic(timeseries===null||timeseries===void 0?void 0:timeseries[highlightedDate],chartType,statistic),statisticConfig.format!=='short'?statisticConfig.format:'int',statistic)),/*#__PURE__*/React.createElement(\"h6\",null,\"\".concat(delta>0?'+':'').concat(formatNumber(delta,statisticConfig.format!=='short'?statisticConfig.format:'int',statistic))))),/*#__PURE__*/React.createElement(\"svg\",{ref:function ref(element){refs.current[index]=element;},preserveAspectRatio:\"xMidYMid meet\"},/*#__PURE__*/React.createElement(\"g\",{className:\"x-axis\"}),/*#__PURE__*/React.createElement(\"g\",{className:\"x-axis2\"}),/*#__PURE__*/React.createElement(\"g\",{className:\"y-axis\"})));})));}var isEqual=function isEqual(prevProps,currProps){if(!equal(currProps.chartType,prevProps.chartType)){return false;}else if(!equal(currProps.isUniform,prevProps.isUniform)){return false;}else if(!equal(currProps.isLog,prevProps.isLog)){return false;}else if(!equal(currProps.regionHighlighted.stateCode,prevProps.regionHighlighted.stateCode)){return false;}else if(!equal(currProps.regionHighlighted.districtName,prevProps.regionHighlighted.districtName)){return false;}else if(!equal(currProps.dates,prevProps.dates)){return false;}return true;};export default React.memo(Timeseries,isEqual);","map":{"version":3,"sources":["/home/ubuntu/myprojectdir/tracker/covid19india-react/src/components/Timeseries.js"],"names":["D3_TRANSITION_DURATION","STATISTIC_CONFIGS","TIMESERIES_STATISTICS","useResizeObserver","capitalize","formatNumber","formatDate","getStatistic","parseIndiaDate","classnames","min","max","bisector","axisBottom","axisRight","interpolatePath","scaleTime","scaleLinear","scaleLog","select","mouse","line","curveMonotoneX","transition","equal","React","useCallback","useEffect","useRef","useMemo","useState","useTranslation","margin","top","right","bottom","left","Timeseries","timeseries","dates","chartType","isUniform","isLog","t","refs","wrapperRef","dimensions","highlightedDate","setHighlightedDate","length","getBarWidth","T","current","getBoundingClientRect","width","chartRight","axisWidth","Math","height","chartBottom","barWidth","yBufferTop","yBufferBottom","xScale","clamp","domain","range","numTicksX","xAxis","g","attr","call","ticks","tickFormat","date","xAxis2","yScale","tickValues","tickSize","style","yAxis","num","tickPadding","uniformScaleMin","uniformScaleMax","yScaleUniformLinear","nice","yScaleUniformLog","generateYScale","statistic","mousemove","xm","invert","isNaN","bisectDate","index","dateLeft","dateRight","mouseout","forEach","ref","i","svg","duration","color","selectAll","data","join","enter","append","remove","linePath","curve","x","y","pathLength","getTotalLength","update","attrTween","previous","on","getStatisticDelta","currCount","prevDate","findIndex","prevCount","trail","styles","map","element","push","animationDelay","delta","statisticConfig","displayName","format","isEqual","prevProps","currProps","regionHighlighted","stateCode","districtName","memo"],"mappings":"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","sourcesContent":["import {\n  D3_TRANSITION_DURATION,\n  STATISTIC_CONFIGS,\n  TIMESERIES_STATISTICS,\n} from '../constants';\nimport {useResizeObserver} from '../hooks/useResizeObserver';\nimport {\n  capitalize,\n  formatNumber,\n  formatDate,\n  getStatistic,\n  parseIndiaDate,\n} from '../utils/commonFunctions';\n\nimport classnames from 'classnames';\nimport {min, max, bisector} from 'd3-array';\nimport {axisBottom, axisRight} from 'd3-axis';\nimport {interpolatePath} from 'd3-interpolate-path';\nimport {scaleTime, scaleLinear, scaleLog} from 'd3-scale';\nimport {select, mouse} from 'd3-selection';\nimport {line, curveMonotoneX} from 'd3-shape';\n// eslint-disable-next-line\nimport {transition} from 'd3-transition';\nimport equal from 'fast-deep-equal';\nimport React, {useCallback, useEffect, useRef, useMemo, useState} from 'react';\nimport {useTranslation} from 'react-i18next';\n\n// Chart margins\nconst margin = {top: 15, right: 35, bottom: 25, left: 25};\n\nfunction Timeseries({timeseries, dates, chartType, isUniform, isLog}) {\n  const {t} = useTranslation();\n  const refs = useRef([]);\n\n  const wrapperRef = useRef();\n  const dimensions = useResizeObserver(wrapperRef);\n\n  const [highlightedDate, setHighlightedDate] = useState();\n\n  useEffect(() => {\n    setHighlightedDate(dates[dates.length - 1]);\n  }, [dates]);\n\n  const getBarWidth = useCallback(() => {\n    const T = dates.length;\n    // Dimensions\n    const {width} = dimensions || wrapperRef.current.getBoundingClientRect();\n    // Chart extremes\n    const chartRight = width - margin.right;\n    // Bar widths\n    const axisWidth = chartRight - margin.left;\n    return Math.min(4, axisWidth / (1.25 * T));\n  }, [dates.length, dimensions]);\n\n  useEffect(() => {\n    const T = dates.length;\n    // Dimensions\n    const {width, height} =\n      dimensions || wrapperRef.current.getBoundingClientRect();\n    // Chart extremes\n    const chartRight = width - margin.right;\n    const chartBottom = height - margin.bottom;\n    const barWidth = getBarWidth();\n\n    // Buffer space along y-axis\n    const yBufferTop = 1.2;\n    const yBufferBottom = 1.1;\n\n    const xScale = scaleTime()\n      .clamp(true)\n      .domain(T ? [parseIndiaDate(dates[0]), parseIndiaDate(dates[T - 1])] : [])\n      .range([margin.left, chartRight]);\n\n    // Number of x-axis ticks\n    const numTicksX = width < 480 ? 4 : 7;\n\n    const xAxis = (g) =>\n      g.attr('class', 'x-axis').call(\n        axisBottom(xScale)\n          .ticks(numTicksX)\n          .tickFormat((date) => formatDate(date, 'dd MMM'))\n      );\n\n    const xAxis2 = (g, yScale) => {\n      g.attr('class', 'x-axis2')\n        .call(axisBottom(xScale).tickValues([]).tickSize(0))\n        .select('.domain')\n        .style('transform', `translateY(${yScale(0)}px)`);\n\n      if (yScale(0) !== chartBottom) g.select('.domain').attr('opacity', 0.4);\n      else g.select('.domain').attr('opacity', 0);\n    };\n\n    const yAxis = (g, yScale) =>\n      g.attr('class', 'y-axis').call(\n        axisRight(yScale)\n          .ticks(4)\n          .tickFormat((num) => formatNumber(num, 'short'))\n          .tickPadding(4)\n      );\n\n    const uniformScaleMin = min(dates, (date) =>\n      getStatistic(timeseries[date], chartType, 'active')\n    );\n\n    const uniformScaleMax = max(dates, (date) =>\n      Math.max(\n        getStatistic(timeseries[date], chartType, 'confirmed'),\n        getStatistic(timeseries[date], chartType, 'recovered'),\n        getStatistic(timeseries[date], chartType, 'deceased')\n      )\n    );\n\n    const yScaleUniformLinear = scaleLinear()\n      .clamp(true)\n      .domain([uniformScaleMin, Math.max(1, yBufferTop * uniformScaleMax)])\n      .nice(4)\n      .range([chartBottom, margin.top]);\n\n    const yScaleUniformLog = scaleLog()\n      .clamp(true)\n      .domain([\n        Math.max(1, uniformScaleMin),\n        Math.max(10, yBufferTop * uniformScaleMax),\n      ])\n      .nice(4)\n      .range([chartBottom, margin.top]);\n\n    const generateYScale = (statistic) => {\n      if (isUniform && chartType === 'total' && isLog && statistic !== 'tested')\n        return yScaleUniformLog;\n\n      if (isUniform && statistic !== 'tested') return yScaleUniformLinear;\n\n      if (chartType === 'total' && isLog)\n        return scaleLog()\n          .clamp(true)\n          .domain([\n            Math.max(\n              1,\n              min(dates, (date) =>\n                getStatistic(timeseries[date], chartType, statistic)\n              )\n            ),\n            Math.max(\n              10,\n              yBufferTop *\n                max(dates, (date) =>\n                  getStatistic(timeseries[date], chartType, statistic)\n                )\n            ),\n          ])\n          .nice(4)\n          .range([chartBottom, margin.top]);\n\n      return scaleLinear()\n        .clamp(true)\n        .domain([\n          yBufferBottom *\n            Math.min(\n              0,\n              min(dates, (date) =>\n                getStatistic(timeseries[date], chartType, statistic)\n              )\n            ),\n          Math.max(\n            1,\n            yBufferTop *\n              max(dates, (date) =>\n                getStatistic(timeseries[date], chartType, statistic)\n              )\n          ),\n        ])\n        .nice(4)\n        .range([chartBottom, margin.top]);\n    };\n\n    function mousemove() {\n      const xm = mouse(this)[0];\n      const date = xScale.invert(xm);\n      if (!isNaN(date)) {\n        const bisectDate = bisector((date) => parseIndiaDate(date)).left;\n        const index = bisectDate(dates, date, 1);\n        const dateLeft = dates[index - 1];\n        const dateRight = dates[index];\n        setHighlightedDate(\n          date - parseIndiaDate(dateLeft) < parseIndiaDate(dateRight) - date\n            ? dateLeft\n            : dateRight\n        );\n      }\n    }\n\n    function mouseout() {\n      setHighlightedDate(dates[T - 1]);\n    }\n\n    /* Begin drawing charts */\n    refs.current.forEach((ref, i) => {\n      const svg = select(ref);\n      const t = svg.transition().duration(D3_TRANSITION_DURATION);\n\n      const statistic = TIMESERIES_STATISTICS[i];\n      const yScale = generateYScale(statistic);\n      const color = STATISTIC_CONFIGS[statistic].color;\n\n      /* X axis */\n      svg\n        .select('.x-axis')\n        .style('transform', `translateY(${chartBottom}px)`)\n        .transition(t)\n        .call(xAxis);\n\n      svg.select('.x-axis2').transition(t).call(xAxis2, yScale);\n\n      /* Y axis */\n      svg\n        .select('.y-axis')\n        .style('transform', `translateX(${chartRight}px)`)\n        .transition(t)\n        .call(yAxis, yScale);\n\n      /* Path dots */\n      svg\n        .selectAll('circle')\n        .data(dates, (date) => date)\n        .join((enter) =>\n          enter\n            .append('circle')\n            .attr('fill', color)\n            .attr('stroke', color)\n            .attr('cy', chartBottom)\n            .attr('cx', (date) => xScale(parseIndiaDate(date)))\n            .attr('r', barWidth / 2)\n        )\n        .transition(t)\n        .attr('cx', (date) => xScale(parseIndiaDate(date)))\n        .attr('cy', (date) =>\n          yScale(getStatistic(timeseries[date], chartType, statistic))\n        );\n\n      if (chartType === 'total') {\n        svg\n          .selectAll('.stem')\n          .transition(t)\n          .attr('y1', yScale(0))\n          .attr('y2', yScale(0))\n          .remove();\n\n        const linePath = line()\n          .curve(curveMonotoneX)\n          .x((date) => xScale(parseIndiaDate(date)))\n          .y((date) =>\n            yScale(getStatistic(timeseries[date], chartType, statistic))\n          );\n\n        let pathLength;\n\n        svg\n          .selectAll('.trend')\n          .data(T ? [dates] : [])\n          .join(\n            (enter) =>\n              enter\n                .append('path')\n                .attr('class', 'trend')\n                .attr('fill', 'none')\n                .attr('stroke', color + '50')\n                .attr('stroke-width', 4)\n                .attr('d', linePath)\n                .attr('stroke-dasharray', function () {\n                  return (pathLength = this.getTotalLength());\n                })\n                .call((enter) =>\n                  enter\n                    .attr('stroke-dashoffset', pathLength)\n                    .transition(t)\n                    .attr('stroke-dashoffset', 0)\n                ),\n            (update) =>\n              update\n                .attr('stroke-dasharray', null)\n                .transition(t)\n                .attrTween('d', function (date) {\n                  const previous = select(this).attr('d');\n                  const current = linePath(date);\n                  return interpolatePath(previous, current);\n                })\n          );\n      } else {\n        /* DAILY TRENDS */\n        svg.selectAll('.trend').remove();\n\n        svg\n          .selectAll('.stem')\n          .data(dates, (date) => date)\n          .join((enter) =>\n            enter\n              .append('line')\n              .attr('class', 'stem')\n              .attr('stroke-width', barWidth)\n              .attr('x1', (date) => xScale(parseIndiaDate(date)))\n              .attr('y1', chartBottom)\n              .attr('x2', (date) => xScale(parseIndiaDate(date)))\n              .attr('y2', chartBottom)\n          )\n          .transition(t)\n          .attr('stroke-width', barWidth)\n          .attr('x1', (date) => xScale(parseIndiaDate(date)))\n          .attr('y1', yScale(0))\n          .attr('x2', (date) => xScale(parseIndiaDate(date)))\n          .attr('y2', (date) =>\n            yScale(getStatistic(timeseries[date], chartType, statistic))\n          );\n      }\n\n      svg.selectAll('*').attr('pointer-events', 'none');\n      svg\n        .on('mousemove', mousemove)\n        .on('touchmove', mousemove)\n        .on('mouseout', mouseout)\n        .on('touchend', mouseout);\n    });\n  }, [chartType, dimensions, getBarWidth, isUniform, isLog, timeseries, dates]);\n\n  useEffect(() => {\n    const barWidth = getBarWidth();\n    refs.current.forEach((ref) => {\n      const svg = select(ref);\n      svg\n        .selectAll('circle')\n        .attr('r', (date) =>\n          date === highlightedDate ? barWidth : barWidth / 2\n        );\n    });\n  }, [highlightedDate, getBarWidth]);\n\n  const getStatisticDelta = useCallback(\n    (statistic) => {\n      if (!highlightedDate) return;\n      const currCount = getStatistic(\n        timeseries?.[highlightedDate],\n        chartType,\n        statistic\n      );\n      const prevDate =\n        dates[dates.findIndex((date) => date === highlightedDate) - 1];\n\n      const prevCount = getStatistic(\n        timeseries?.[prevDate],\n        chartType,\n        statistic\n      );\n      return currCount - prevCount;\n    },\n    [timeseries, dates, highlightedDate, chartType]\n  );\n\n  const trail = useMemo(() => {\n    const styles = [];\n\n    [0, 0, 0, 0, 0].map((element, index) => {\n      styles.push({\n        animationDelay: `${index * 250}ms`,\n      });\n      return null;\n    });\n    return styles;\n  }, []);\n\n  return (\n    <React.Fragment>\n      <div className=\"Timeseries\">\n        {TIMESERIES_STATISTICS.map((statistic, index) => {\n          const delta = getStatisticDelta(statistic, index);\n          const statisticConfig = STATISTIC_CONFIGS[statistic];\n          return (\n            <div\n              key={statistic}\n              className={classnames('svg-parent fadeInUp', `is-${statistic}`)}\n              ref={wrapperRef}\n              style={trail[index]}\n            >\n              {highlightedDate && (\n                <div className={classnames('stats', `is-${statistic}`)}>\n                  <h5 className=\"title\">\n                    {t(capitalize(statisticConfig.displayName))}\n                  </h5>\n                  <h5 className=\"title\">\n                    {formatDate(highlightedDate, 'dd MMMM')}\n                  </h5>\n                  <div className=\"stats-bottom\">\n                    <h2>\n                      {formatNumber(\n                        getStatistic(\n                          timeseries?.[highlightedDate],\n                          chartType,\n                          statistic\n                        ),\n                        statisticConfig.format !== 'short'\n                          ? statisticConfig.format\n                          : 'int',\n                        statistic\n                      )}\n                    </h2>\n                    <h6>{`${delta > 0 ? '+' : ''}${formatNumber(\n                      delta,\n                      statisticConfig.format !== 'short'\n                        ? statisticConfig.format\n                        : 'int',\n                      statistic\n                    )}`}</h6>\n                  </div>\n                </div>\n              )}\n              <svg\n                ref={(element) => {\n                  refs.current[index] = element;\n                }}\n                preserveAspectRatio=\"xMidYMid meet\"\n              >\n                <g className=\"x-axis\" />\n                <g className=\"x-axis2\" />\n                <g className=\"y-axis\" />\n              </svg>\n            </div>\n          );\n        })}\n      </div>\n    </React.Fragment>\n  );\n}\n\nconst isEqual = (prevProps, currProps) => {\n  if (!equal(currProps.chartType, prevProps.chartType)) {\n    return false;\n  } else if (!equal(currProps.isUniform, prevProps.isUniform)) {\n    return false;\n  } else if (!equal(currProps.isLog, prevProps.isLog)) {\n    return false;\n  } else if (\n    !equal(\n      currProps.regionHighlighted.stateCode,\n      prevProps.regionHighlighted.stateCode\n    )\n  ) {\n    return false;\n  } else if (\n    !equal(\n      currProps.regionHighlighted.districtName,\n      prevProps.regionHighlighted.districtName\n    )\n  ) {\n    return false;\n  } else if (!equal(currProps.dates, prevProps.dates)) {\n    return false;\n  }\n  return true;\n};\n\nexport default React.memo(Timeseries, isEqual);\n"]},"metadata":{},"sourceType":"module"}